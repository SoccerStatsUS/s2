{% extends "base.html" %}
{% load datum_or_none %}

{% block title %}{{ team.name }} Results, Lineups, & Statistics{% endblock %}
{% block metadescription %}{{ team.name }} soccer stats with results, lineups, awards, all-time stats, managers...{% endblock %}

{% block extrahead %}

<script type="text/javascript">
  $(document).ready(function (){
  $("div[tab='games']").load("{% url games_ajax_by_id %}?team={{ team.id }}");
  $("div[tab='stats']").load("{% url stats_ajax_by_id %}?team={{ team.id }}&type=team");
  });
</script>

{% endblock %}


{% block content %}

<h2>{{ team.name }}</h2>


<ul id="tabs"></ul>

<div id="tab_wrapper">

<div tab="summary">

<h3>Competition standings</h3>

<table>

<tr>
  <th>cmp</th>
  <th>W</th>
  <th>T</th>
  <th>L</th>
  <th>win %</th>
</tr>

{% for standing in competition_standings %}
<tr>
  {% if standing.competition == None %}
  <td>All-time</td>
  {% else %}
  <td><a href="{% url competition_detail standing.competition.slug %}">{{ standing.competition }}</a></td>
  {% endif %}
  <td>{{ standing.wins }}</td>
  {% datum_or_grey standing.ties %}
  <td>{{ standing.losses }}</td>
  <td>{{ standing.win_percentage_100|floatformat }}%</td>
</tr>
{% endfor %}
</table>


{% if team.awards.exists %}
<h3>Honors</h3>
<table>
{% for award in team.awards.all %}
<tr>
  <td><a href="{% url season_detail award.season.competition.slug award.season.slug %}">{{ award.season.name }}</a></td>
  <td><a href="{% url award_detail award.award.id %}">{{ award.award.name }}</a></td>
  <td><a href="{% url competition_detail award.award.competition.slug %}">{{ award.award.competition }}</a></td>
</tr>
{% endfor %}
</table>
{% endif %}

{% if goal_leaders %}
<h3>Goal leaders</h3>
<table>
{% for e in goal_leaders %}
<tr>
  <td><a href="{% url person_detail e.player.slug %}">{{ e.player }}</a></td>
  <td>{{ e.goals }}</td>
</tr>
{% endfor %}
</table>
{% endif %}

{% if game_leaders %}
<h3>Game leaders</h3>
<table>
{% for e in game_leaders %}
<tr>
  <td><a href="{% url person_detail e.player.slug %}">{{ e.player }}</a></td>
  <td>{{ e.games_played }}</td>
</tr>
{% endfor %}
</table>
{% endif %}


{% if recent_picks %}
<h3>Draft picks</h3> 
<table>
{% for e in recent_picks %}
<tr>
  <td>{{ e.draft.season }}</td>
  <td><a href="{% url person_detail e.player.slug %}">{{ e.player }}</a></td>
</tr>
{% endfor %}
</table>
<p>(<a href="{% url team_picks team.slug %}">complete</a>)</p>
{% endif %}


{% if head_coaches %}
<h3>Coaches</h3>
<table>

<thead>
  <tr>
    <th>name</th>
    <th>start</th>
    <th>end</th>
    <th>wins</th>
    <th>losses</th>
    <th>ties</th>
    
    {% comment %}
    <th>%</th>
    {% endcomment %}

  </tr>
</thead>

{% for position in head_coaches %}
<tr>
  <td><a href="{% url person_detail position.person.slug %}">{{ position.person }}</a></td>
  {% if position.start %}
  <td><a href="{% url date_detail position.start.year position.start.month position.start.day %}">{{ position.start|date:"m-d-Y" }}</a></td>
  {% else %}
  <td></td>
  {% endif %}

  {% if position.end %}
  <td><a href="{% url date_detail position.end.year position.end.month position.end.day %}">{{ position.end|date:"m-d-Y" }}</td>
  {% else %}
  <td></td>
  {% endif %}

  {% datum_or_grey position.wins %}
  {% datum_or_grey position.losses %}
  {% datum_or_grey position.ties %}
  {% with wp=position.win_percentage|floatformat:3 %}
  {% datum_or_grey wp %}
  {% endwith %}

</tr>
{% endfor %}
</table>

{% endif %}


</div>



{% if team.standing_set.exists %}
<div tab="standings">
{% include "templatetags/standings.html" with standings=team.standings_by_date %}
</div>
{% endif %}

{% if stats %}
<div tab="stats">
</div>
{% endif %}

{% if team.game_set.exists %}

<div tab="games">

</div>

{% comment %}
<a href="">All games</a>
{% endcomment %}

{% endif %}


{% if current_staff %}
<div tab="staff">

<table>
{% for position in current_staff %}
<tr>
  <td><a href="{% url person_detail position.person.slug %}">{{ position.person }}</a></td>
  <td>{{ position.name }}</td>
  {% if position.start %}
  <td><a href="{% url date_detail position.start.year position.start.month position.start.day %}">{{ position.start|default_if_none:'' }}</a></td>
  {% else %}
  <td></td>
  {% endif %}

</tr>
{% endfor %}
</table>
</div>
{% endif %}



{% if team.pick_set.exists %}
<div tab="draft picks">
{% include "templatetags/draft_small.html" with picks=team.pick_set.all %}
</div>
{% endif %}


</div>

{% endblock %}

