{% load datum_or_none %}
{% load url from future %}

<div id="game_score">
  <div id="team_results">

  <h3>
    {% if game.season_previous_game %}<a href="{% url 'game_detail' game.season_previous_game.id %}">←</a>{% endif %}
    <a href="{% url 'competition_detail' game.competition.slug %}">{{ game.competition }}</a> - 
    <a href="{% url 'season_detail' game.competition.slug game.season.slug %}">{{ game.season.name }}</a>
    {% if game.season_next_game %}<a href="{% url 'game_detail' game.season_next_game.id %}">→</a>{% endif %}
  </h3>
    
  <h3>
    {% if game.date %}
    <a href="{% url 'date_detail' game.date.year game.date.month game.date.day %}">{{ game.date|date:"l, F d, Y" }}</a>
  {% endif %}
  
  {% if game.stadium.slug %}
    at <a href="{% url 'stadium_detail' game.stadium.slug %}">{{ game.stadium }}</a>
    {% else %}
    {% if game.stadium %}
    at {{ game.stadium }}
    {% else %}
    {% if game.location %}
    in {{ game.location }}
    {% endif %}
    {% endif %}
    {% endif %}
  </h3>

  <ul>
    {% if game.referee %}
    <li><a href="{% url 'person_detail' game.referee.slug %}">{{ game.referee }}</a> referee </li>
    {% endif %}

    {% if game.attendance %}
    <li>{{ game.attendance }} attendance</li>
    {% endif %}
  </ul>

    <div class="team_data">
      <div class="team"><a href="{% url 'team_detail' game.team1.slug %}">{{ game.team1_original_name  }}</a></div>
      {# <div><a href="{% url 'team_season_detail' game.team1.slug game.competition.slug game.season.slug %}">{{ game.season.name }}</a></div> #}
      <div class="score">{{ game.team1_score_or_result }}</div>

      {% if game.home_standings_string %}
      <div>
        {% if game.team1_previous_game %}<a href="{% url 'game_detail' game.team1_previous_game.id %}">←</a>{% endif %}
        <a href="{% url 'season_detail' game.competition.slug game.season.slug %}">{{ game.home_standings_string  }}</a>
        {% if game.team1_next_game %}<a href="{% url 'game_detail' game.team1_next_game.id %}">→</a>{% endif %}
      </div>
      {% endif %}
    </div>

    <div class="team_data">
      <div class="team"><a href="{% url 'team_detail' game.team2.slug %}">{{ game.team2_original_name  }}</a></div>
      {# <div><a href="{% url 'team_season_detail' game.team2.slug game.competition.slug game.season.slug %}">{{ game.season.name }}</a></div> #}
      <div class="score">{{ game.team2_score_or_result }}</div>
      {% if game.away_standings_string %}
      <div>
        {% if game.team2_previous_game %}<a href="{% url 'game_detail' game.team2_previous_game.id %}">←</a>{% else %}←{% endif %}
        <a href="{% url 'season_detail' game.competition.slug game.season.slug %}">{{ game.away_standings_string  }}</a>
        {% if game.team2_next_game %}<a href="{% url 'game_detail' game.team2_next_game.id %}">→</a>{% else %}→{% endif %}
      </div>

      {% endif %}
    </div>

    {% if game.forfeit %}<h3>Forfeit</h3>{% endif %}

  </div>
</div>

<div class="clear_both"></div>


{% if game.goal_set.exists %}

<table id="goal_list" class="noborder">

  {% for goal in game.goal_set.all %}
  <tr>

    {% if goal.team == game.team1 %}
    {% include "templatetags/fragments/goal.html"  %}
    {% else %}
    <td></td>
    {% endif %}

    {% datum_or_grey goal.minute %}

    {% if goal.team == game.team2 %}
    {% include "templatetags/fragments/goal.html"  %}
    {% else %}
    <td></td>
    {% endif %}

    {# <td><a href="{% url 'team_detail' goal.team.slug %}">{{ goal.team }}</a></td> #}





    {# <td></td> #}
  {% endfor %}
</table>

{% endif %}

{% if game.appearance_set.exists %}
{% include "templatetags/games/detail/lineup.html"  %}

{% else %}

{% if game.gamestat_set.exists %}
{% include "templatetags/games/detail/gamestats.html"  %}
{% endif %}

{% endif %}


